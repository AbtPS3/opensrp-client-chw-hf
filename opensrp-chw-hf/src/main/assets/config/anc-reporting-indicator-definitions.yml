indicators:
  - key: "2a-10-14"
    description: "Gestation age less than 12 weeks for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age < 12
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  - key: "2b-10-14"
    description: "Gestation age greater than or equals to 12 weeks for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age >= 12
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2c-10-14"
    description: "Followup visits for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number > 1
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2d-10-14"
    description: "Followup visits for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number >= 4
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2e-10-14"
    description: "Clients Who Tested HB Levels on First Visit 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND eaf.hb_level IS NOT NULL
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "4b-10-14"
    description: "Pregnant Clients 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "4d-10-14"
    description: "Clients with HB Level less than 8.5 for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.hb_level AS FLOAT) < 8.5
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "4e-10-14"
    description: "Clients with BP greater than or equalts to 140/90 mm/hg for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.systolic AS INTEGER) > 140
                        AND CAST(eaf.diastolic AS INTEGER) > 90
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "4g-10-14"
    description: "Clients with glucose in urine for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.glucose_in_urine = 'positive'
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  - key: "4h-10-14"
    description: "Clients with protein in urine for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.protein_in_urine = 'positive'
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
    
  - key: "4i-10-14"
    description: "Clients tested syphilis for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.syphilis <> 'test_not_conducted'
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
    
  - key: "4j-10-14"
    description: "Clients tested syphilis for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.syphilis = 'positive'
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
    
  - key: "4l-10-14"
    description: "Partners tested syphilis for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.partner_base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.partner_syphilis <> 'test_not_conducted'
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
    
  - key: "4j-10-14"
    description: "Partners tested syphilis for 10 - 14 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.partner_base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.partner_syphilis = 'positive'
                        AND (date(fm.dob, '+10 years') <= date('now'))
                        AND (date(fm.dob, '+15 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  - key: "2a-15-19"
    description: "Gestation age less than 12 weeks for 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age < 12
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+20 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2b-15-19"
    description: "Gestation age greater than or equals to 12 weeks for 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age >= 12
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+19 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2c-15-19"
    description: "Followup visits for 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number > 1
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+20 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2d-15-19"
    description: "Followup visits for 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number >= 4
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+20 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2e-15-19"
    description: "Clients Who Tested HB Levels on First Visit For 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND eaf.hb_level IS NOT NULL
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+20 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "4b-15-19"
    description: "Pregnant Clients 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+20 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"


  - key: "4d-15-19"
    description: "Clients with HB Level less than 8.5 for 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.hb_level AS FLOAT) < 8.5
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+20 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"

  - key: "4e-15-19"
    description: "Clients with BP greater than or equalts to 140/90 mm/hg for 15 - 19 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.systolic AS INTEGER) > 140
                        AND CAST(eaf.diastolic AS INTEGER) > 90
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+15 years') <= date('now'))
                        AND (date(fm.dob, '+20 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2a-20-24"
    description: "Gestation age less than 12 weeks for 20 - 24 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age < 12
                        AND (date(fm.dob, '+20 years') <= date('now'))
                        AND (date(fm.dob, '+25 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2b-20-24"
    description: "Gestation age greater than or equals to 12 weeks for 20 - 24 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age >= 12
                        AND (date(fm.dob, '+20 years') <= date('now'))
                        AND (date(fm.dob, '+25 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  
  - key: "2c-20-24"
    description: "Followup visits for 20 - 24 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number > 1
                        AND (date(fm.dob, '+20 years') <= date('now'))
                        AND (date(fm.dob, '+25 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  
  - key: "2d-20-24"
    description: "Followup visits for 20 - 24 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number >= 4
                        AND (date(fm.dob, '+20 years') <= date('now'))
                        AND (date(fm.dob, '+25 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2e-20-24"
    description: "Clients Who Tested HB Levels on First Visit for 20 - 24 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND eaf.hb_level IS NOT NULL
                        AND (date(fm.dob, '+20 years') <= date('now'))
                        AND (date(fm.dob, '+25 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"


  - key: "4d-20-24"
    description: "Clients with HB Level less than 8.5 for 20 - 24 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.hb_level AS FLOAT) < 8.5
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+20 years') <= date('now'))
                        AND (date(fm.dob, '+25 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"

  - key: "4e-20-24"
    description: "Clients with BP greater than or equalts to 140/90 mm/hg for 20 - 25 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.systolic AS INTEGER) > 140
                        AND CAST(eaf.diastolic AS INTEGER) > 90
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+20 years') <= date('now'))
                        AND (date(fm.dob, '+25 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2a-25-29"
    description: "Gestation age less than 12 weeks for 25 - 29 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age < 12
                        AND (date(fm.dob, '+25 years') <= date('now'))
                        AND (date(fm.dob, '+30 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2b-25-29"
    description: "Gestation age greater than or equals to 12 weeks for 25 - 29 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age >= 12
                        AND (date(fm.dob, '+25 years') <= date('now'))
                        AND (date(fm.dob, '+29 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  
  - key: "2c-25-29"
    description: "Followup visits for 25 - 29 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number > 1
                        AND (date(fm.dob, '+25 years') <= date('now'))
                        AND (date(fm.dob, '+30 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  
  - key: "2d-25-29"
    description: "Followup visits for 25 - 29 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number >= 4
                        AND (date(fm.dob, '+25 years') <= date('now'))
                        AND (date(fm.dob, '+30 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  
  - key: "2e-25-29"
    description: "Clients Who Tested HB Levels on First Visit for 25 - 29 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND eaf.hb_level IS NOT NULL
                        AND (date(fm.dob, '+25 years') <= date('now'))
                        AND (date(fm.dob, '+30 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"


  - key: "4d-25-29"
    description: "Clients with HB Level less than 8.5 for 25 - 29 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.hb_level AS FLOAT) < 8.5
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+25 years') <= date('now'))
                        AND (date(fm.dob, '+30 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"

  - key: "4e-25-29"
    description: "Clients with BP greater than or equalts to 140/90 mm/hg for 25 - 29 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.systolic AS INTEGER) > 140
                        AND CAST(eaf.diastolic AS INTEGER) > 90
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+25 years') <= date('now'))
                        AND (date(fm.dob, '+30 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2a-30-34"
    description: "Gestation age less than 12 weeks for 30 - 34 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age < 12
                        AND (date(fm.dob, '+30 years') <= date('now'))
                        AND (date(fm.dob, '+35 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2b-30-34"
    description: "Gestation age greater than or equals to 12 weeks for 30 - 34 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age >= 12
                        AND (date(fm.dob, '+30 years') <= date('now'))
                        AND (date(fm.dob, '+35 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2c-30-34"
    description: "Followup visits for 30 - 34 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number > 1
                        AND (date(fm.dob, '+30 years') <= date('now'))
                        AND (date(fm.dob, '+35 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2d-30-34"
    description: "Followup visits for 30 - 34 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number >= 4
                        AND (date(fm.dob, '+30 years') <= date('now'))
                        AND (date(fm.dob, '+35 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2e-30-34"
    description: "Clients Who Tested HB Levels on First Visit for 30 - 34 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND eaf.hb_level IS NOT NULL
                        AND (date(fm.dob, '+30 years') <= date('now'))
                        AND (date(fm.dob, '+35 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"

  - key: "4d-30-34"
    description: "Clients with HB Level less than 8.5 for 30 - 34 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.hb_level AS FLOAT) < 8.5
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+30 years') <= date('now'))
                        AND (date(fm.dob, '+35 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"

  - key: "4e-30-34"
    description: "Clients with BP greater than or equalts to 140/90 mm/hg for 30 - 34 year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.systolic AS INTEGER) > 140
                        AND CAST(eaf.diastolic AS INTEGER) > 90
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+30 years') <= date('now'))
                        AND (date(fm.dob, '+35 years') > date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
    
  - key: "2a-35+"
    description: "Gestation age less than 12 weeks for 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age < 12
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  
  - key: "2b-35+"
    description: "Gestation age greater than or equals to 12 weeks for 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE gest_age >= 12
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(ear.confirmation_date, 7, 4) || '-' || substr(ear.confirmation_date, 4, 2) || '-' || '01')"
  
  - key: "2c-35+"
    description: "Followup visits for 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number > 1
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2d-35+"
    description: "Followup visits for 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number >= 4
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
  
  - key: "2e-35+"
    description: "Clients Who Tested HB Levels on First Visit for 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE eaf.visit_number = 1
                        AND eaf.hb_level IS NOT NULL
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"

  - key: "4c-35+"
    description: "Pregnant Clients 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                      WHERE eaf.visit_number = 1
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"
    
  - key: "4d-35+"
    description: "Clients with HB Level less than 8.5 for 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.hb_level AS FLOAT) < 8.5
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"

  - key: "4e-35+"
    description: "Clients with BP greater than or equalts to 140/90 mm/hg for 35+ year olds"
    indicatorQuery: " SELECT count(DISTINCT ear.base_entity_id) as count
                      FROM ec_anc_register ear
                               INNER JOIN ec_family_member fm on fm.base_entity_id = ear.base_entity_id
                               INNER JOIN ec_anc_followup eaf on fm.base_entity_id = eaf.entity_id
                      WHERE CAST(eaf.systolic AS INTEGER) > 140
                        AND CAST(eaf.diastolic AS INTEGER) > 90
                        AND eaf.visit_number = 1
                        AND (date(fm.dob, '+35 years') <= date('now'))
                        AND date((substr('%s', 1, 4) || '-' || substr('%s', 6, 2) || '-' || '01'), '-1 months') =
                            date(substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 1, 4) ||
                                 '-' ||
                                 substr(strftime('%Y-%m-%d', datetime(eaf.visit_date / 1000, 'unixepoch', 'localtime')), 6, 2) ||
                                 '-' || '01')"